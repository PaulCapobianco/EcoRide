<?php declare(strict_types=1); ?>
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EcoRide — Ajouter un véhicule</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <script defer type="module" src="assets/js/main.js"></script>
</head>
<body>

  <?php require_once __DIR__ . '/includes/header.phtml'; ?>

  <main class="page page-vehicle">
    <section class="layout-container">

      <!-- Titre + intro -->
      <header class="page-head text-center my-3 my-md-4">
        <h1 class="page-title mb-1">Ajouter un véhicule</h1>
        <p class="page-lead text-muted mb-0">
          Les champs marqués <strong>(*)</strong> sont obligatoires.
        </p>
      </header>

      <!-- Formulaire -->
      <div class="card form-card mx-auto">
        <div class="card-body">
          <form class="needs-validation" action="#" method="post" enctype="multipart/form-data" novalidate>
            <div class="row g-3">

              <!-- Marque / Modèle -->
              <div class="col-12 col-md-6">
                <label for="brand" class="form-label">Marque <strong>(*)</strong></label>
                <input type="text" class="form-control" id="brand" name="brand" placeholder="Peugeot, Renault…" required>
                <div class="invalid-feedback">La marque est requise.</div>
              </div>
              <div class="col-12 col-md-6">
                <label for="model" class="form-label">Modèle <strong>(*)</strong></label>
                <input type="text" class="form-control" id="model" name="model" placeholder="308, Clio…" required>
                <div class="invalid-feedback">Le modèle est requis.</div>
              </div>

              <!-- Année / Couleur / Places -->
              <div class="col-12 col-md-4">
                <label for="year" class="form-label">Année <strong>(*)</strong></label>
                <input type="number" class="form-control" id="year" name="year" min="1980" max="2035" placeholder="2020" required>
                <div class="invalid-feedback">Indique une année valide (1980–2035).</div>
              </div>

              <div class="col-12 col-md-4">
                <label for="color" class="form-label">Couleur <strong>(*)</strong></label>
                <select class="form-select" id="color" name="color" required>
                  <option value="" selected disabled>Choisir…</option>
                  <option>Blanc</option>
                  <option>Noir</option>
                  <option>Gris</option>
                  <option>Bleu</option>
                  <option>Rouge</option>
                  <option>Vert</option>
                  <option>Autre</option>
                </select>
                <div class="invalid-feedback">Choisis une couleur.</div>
              </div>

              <div class="col-12 col-md-4">
                <label for="seats" class="form-label">Places <strong>(*)</strong></label>
                <select class="form-select" id="seats" name="seats" required>
                  <option value="" selected disabled>Choisir…</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                  <option>6</option>
                  <option>7</option>
                </select>
                <div class="invalid-feedback">Indique le nombre de places.</div>
              </div>

              <!-- Énergie (NOUVEAU) -->
              <div class="col-12 col-md-6">
                <label for="energy" class="form-label">Énergie <strong>(*)</strong></label>
                <select class="form-select" id="energy" name="energy" required aria-describedby="energyHelp">
                  <option value="" selected disabled>Choisir…</option>
                  <option value="essence">Essence</option>
                  <option value="diesel">Diesel</option>
                  <option value="hybride">Hybride</option>
                  <option value="electrique">Électrique</option>
                  <option value="hydrogene">Hydrogène</option>
                  <option value="gnv">GNV</option>
                </select>
                <div id="energyHelp" class="form-text">
                  Hybride / Électrique / Hydrogène / GNV = <span class="badge bg-success">EcoRider</span>.
                </div>
                <!-- Badge aperçu EcoRider -->
                <div id="ecoBadge" class="mt-2 d-none">
                  <span class="badge bg-success">EcoRider</span>
                  <small class="text-muted ms-1">véhicule écologique</small>
                </div>
                <div class="invalid-feedback">Sélectionne une énergie.</div>
              </div>

              <!-- Immatriculation -->
              <div class="col-12 col-md-6">
                <label for="plate" class="form-label">Immatriculation <strong>(*)</strong></label>
                <input
                  type="text"
                  class="form-control"
                  id="plate"
                  name="plate"
                  placeholder="AA-123-AA"
                  pattern="^[A-Z]{2}-\d{3}-[A-Z]{2}$"
                  title="Format FR attendu : AA-123-AA"
                  required>
                <div class="invalid-feedback">Format attendu : AA-123-AA.</div>
              </div>

              <!-- Photo -->
              <div class="col-12 col-md-6">
                <label for="photo" class="form-label">Photo du véhicule</label>
                <input class="form-control" type="file" id="photo" name="photo" accept="image/*">
                <div class="form-text">Formats acceptés : JPG, PNG (max 5 Mo).</div>
              </div>

              <!-- Date de 1ère immatriculation -->
              <div class="col-12 col-md-6">
                <label for="first_registration" class="form-label">Date de 1<sup>ère</sup> immatriculation <strong>(*)</strong></label>
                <input
                  type="date"
                  class="form-control"
                  id="first_registration"
                  name="first_registration_date"
                  required
                  min="1980-01-01"
                  max="<?= date('Y-m-d') ?>"
                  aria-describedby="firstRegHelp">
                <div id="firstRegHelp" class="form-text">La “mise en circulation” figurant sur la carte grise.</div>
                <div class="invalid-feedback">Indique une date valide (pas dans le futur).</div>
              </div>

              <!-- Options (préférences côté véhicule) -->
              <div class="col-12">
                <label class="form-label d-block">Options</label>
                <div class="row g-2">
                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="1" id="opt-ac" name="options[ac]">
                      <label class="form-check-label" for="opt-ac">Climatisation</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="1" id="opt-music" name="options[music]">
                      <label class="form-check-label" for="opt-music">Musique OK</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="1" id="opt-pets" name="options[pets]">
                      <label class="form-check-label" for="opt-pets">Animaux acceptés</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="1" id="opt-baggage" name="options[baggage]">
                      <label class="form-check-label" for="opt-baggage">Bagages volumineux</label>
                    </div>
                  </div>
                  <div class="col-12 col-sm-6 col-lg-4">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="1" id="opt-nonfum" name="options[noSmoking]">
                      <label class="form-check-label" for="opt-nonfum">Non-fumeur</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Description -->
              <div class="col-12">
                <label for="desc" class="form-label">Description</label>
                <textarea class="form-control" id="desc" name="description" rows="5" placeholder="Infos utiles pour vos passagers (confort, coffre, etc.)."></textarea>
              </div>

              <!-- Actions -->
              <div class="col-12 d-flex flex-column flex-sm-row gap-2 mt-2">
                <a href="profile.phtml#section-vehicules" class="btn btn-outline-secondary flex-fill flex-sm-grow-0">
                  Annuler
                </a>
                <button type="submit" class="btn btn-success flex-fill">
                  Enregistrer le véhicule
                </button>
              </div>

            </div>
          </form>
        </div>
      </div>

    </section>
  </main>

  <?php require_once __DIR__ . '/includes/footer.phtml'; ?>

</body>
</html>

